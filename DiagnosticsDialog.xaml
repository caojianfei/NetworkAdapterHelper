<Window x:Class="NetworkAdapterHelper.DiagnosticsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="诊断信息" 
        Height="400" 
        Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Margin="16">
            <StackPanel>
                <TextBlock Text="快捷键钩子状态" 
                         FontSize="16" 
                         FontWeight="Bold" 
                         Margin="0,0,0,12"/>
                
                <TextBlock x:Name="HookStatusText" 
                         Text="正在加载..." 
                         TextWrapping="Wrap"
                         FontFamily="Consolas"
                         FontSize="12"
                         Margin="0,0,0,16"/>

                <TextBlock Text="操作" 
                         FontSize="16" 
                         FontWeight="Bold" 
                         Margin="0,0,0,12"/>
                
                <Button Content="重新安装钩子" 
                        Click="ReinstallHook_Click"
                        Width="150"
                        Height="32"
                        HorizontalAlignment="Left"
                        Margin="0,0,0,8"/>
                
                <Button Content="刷新状态" 
                        Click="RefreshStatus_Click"
                        Width="150"
                        Height="32"
                        HorizontalAlignment="Left"/>
            </StackPanel>
        </ScrollViewer>

        <Border Grid.Row="1" 
                Background="#FFF8F9FA" 
                BorderBrush="#FFCCCCCC" 
                BorderThickness="0,1,0,0"
                Padding="16,12">
            <Button Content="关闭" 
                    Click="Close_Click"
                    Width="80"
                    Height="32"
                    HorizontalAlignment="Right"/>
        </Border>
    </Grid>
</Window>
